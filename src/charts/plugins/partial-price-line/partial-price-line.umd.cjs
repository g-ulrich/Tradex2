(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("lightweight-charts")):typeof define=="function"&&define.amd?define(["exports","lightweight-charts"],t):(i=typeof globalThis<"u"?globalThis:i||self,t(i.PartialPriceLine={},i.LightweightCharts))})(this,function(i,t){"use strict";var x=Object.defineProperty;var w=(i,t,h)=>t in i?x(i,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):i[t]=h;var c=(i,t,h)=>(w(i,typeof t!="symbol"?t+"":t,h),h);function h(s){return Math.floor(s*.5)}function d(s,r,e=1,n){const l=Math.round(r*s),a=n?e:Math.round(e*r),o=h(a);return{position:l-o,length:a}}class _{constructor(){c(this,"_price",null);c(this,"_x",null);c(this,"_color","#000000")}update(r,e,n){this._price=r,this._color=e,this._x=n}draw(r){r.useBitmapCoordinateSpace(e=>{if(this._price===null||this._x===null)return;const n=Math.round(this._x*e.horizontalPixelRatio),l=d(this._price,e.verticalPixelRatio,e.verticalPixelRatio),a=l.position+l.length/2,o=e.context;o.beginPath(),o.setLineDash([4*e.verticalPixelRatio,2*e.verticalPixelRatio]),o.moveTo(n,a),o.lineTo(e.bitmapSize.width,a),o.strokeStyle=this._color,o.lineWidth=e.verticalPixelRatio,o.stroke()})}}class p{constructor(){c(this,"_renderer");this._renderer=new _}renderer(){return this._renderer}update(r,e,n){this._renderer.update(r,e,n)}}class f{constructor(){c(this,"_paneViews");c(this,"_chart",null);c(this,"_series",null);this._paneViews=[new p]}attached({chart:r,series:e}){this._chart=r,this._series=e,this._series.applyOptions({priceLineVisible:!1})}detached(){this._chart=null,this._series=null}updateAllViews(){if(!this._series||!this._chart)return;const r=this._series.options();let e=r.priceLineColor||r.color||"#000000";const n=this._series.dataByIndex(1e5,t.MismatchDirection.NearestLeft);let l=null,a=null;n&&(n.color!==void 0&&(e=n.color),l=P(n),a=this._chart.timeScale().timeToCoordinate(n.time));const o=l!==null?this._series.priceToCoordinate(l):null;this._paneViews.forEach(u=>u.update(o,e,a))}paneViews(){return this._paneViews}}function P(s){return s.value!==void 0?s.value:s.close!==void 0?s.close:null}i.PartialPriceLine=f,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
